"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[863],{2863:(xt,I,n)=>{n.r(I),n.d(I,{default:()=>ht});var L=n(8104),t=n(597),u=n(6767),A=n(1559),R=n(4013),D=n(3810),O=n(3504),k=n(8217),Q=n(3749),V=n(4160),N=n(7459),z=n(5053),Y=n(6865),$=n(9158),X=function(){return $.Z.Date.now()};const B=X;var E=n(8071),G="Expected a function",J=Math.max,K=Math.min;function q(T,d,y){var r,p,S,f,i,c,v=0,W=!1,g=!1,o=!0;if(typeof T!="function")throw new TypeError(G);d=(0,E.Z)(d)||0,(0,Y.Z)(y)&&(W=!!y.leading,g="maxWait"in y,S=g?J((0,E.Z)(y.maxWait)||0,d):S,o="trailing"in y?!!y.trailing:o);function m(s){var e=r,a=p;return r=p=void 0,v=s,f=T.apply(a,e),f}function w(s){return v=s,i=setTimeout(F,d),W?m(s):f}function U(s){var e=s-c,a=s-v,l=d-e;return g?K(l,S-a):l}function x(s){var e=s-c,a=s-v;return c===void 0||e>=d||e<0||g&&a>=S}function F(){var s=B();if(x(s))return b(s);i=setTimeout(F,U(s))}function b(s){return i=void 0,o&&r?m(s):(r=p=void 0,f)}function j(){i!==void 0&&clearTimeout(i),v=0,r=c=p=i=void 0}function M(){return i===void 0?f:b(B())}function h(){var s=B(),e=x(s);if(r=arguments,p=this,c=s,e){if(i===void 0)return w(c);if(g)return clearTimeout(i),i=setTimeout(F,d),m(c)}return i===void 0&&(i=setTimeout(F,d)),f}return h.cancel=j,h.flush=M,h}const _=q;var tt=n(1532),H=n.n(tt),et=n(5655),nt=n(4120),P=n.n(nt);const st={class:"py-6 lg:py-8"},rt=(0,t.Uk)("Carbar | Search"),at={class:"container flex"},it={class:"w-3/12"},lt={class:"w-9/12"},ot={class:"flex flex-col pb-8 border-b border-gray-300"},ut=(0,t._)("h1",{class:"mt-5 mb-0"},"Car subscriptions",-1),ct={class:"flex flex-col mt-6"},dt={class:"flex justify-end"},ft={class:"flex gap-x-6"},vt={key:0,class:"font-bold"},mt={class:"flex"},yt=(0,t._)("span",{class:"font-medium"},"Sort by:\xA0\xA0",-1),gt={class:"mt-6"},ht={props:{response:{type:Object}},emits:["click"],setup(T,{emit:d}){const y=T,r=(0,et.M)(),p=(0,L.tv)(),S=(0,L.yj)(),f=[{title:"Home",url:"/"},{title:"Cars"}],i=(0,t.Fl)(()=>r.facets),c=(0,t.Fl)(()=>r.filters),v=(0,t.Fl)(()=>r.facets.sortBy),W=(0,t.Fl)(()=>r.filters.sortBy),g=(0,t.Fl)(()=>(0,z.Z)(v.value,e=>e.slug===W.value)),o=(0,t.Fl)(()=>r.productsPagination),m=(0,t.Fl)(()=>r.getCurrentQuery),w=(0,t.Fl)(()=>{if(parseInt(o.value.currentPage)===1)return null;const e=m.value;return e.page(o.value.currentPage-1),e._builder.query()}),U=(0,t.Fl)(()=>{if(o.value.isLastPage)return null;const e=m.value;return e.page(o.value.currentPage+1),e._builder.query()}),x=(0,u.iH)(!1);(0,t.YP)(c,async(e,a)=>{!x.value||await b()},{deep:!0}),(0,t.YP)(()=>o.value.current,async(e,a)=>{!x.value||await b()}),(0,t.vl)(async()=>{P().info("onServerPrefetch"),await F(),await h()}),(0,t.bv)(async()=>{P().log("onMounted"),i.value.bodyTypes.length===0&&(P().warn("Server side fetch failed. Fetching on the client side"),await h()),x.value=!0});const F=async()=>{let e=H().parse(S.query);if(!e.filter)return;let a={};for(const[l,Z]of Object.entries(e.filter)){if(!i.value[l])continue;let C=Z;Array.isArray(c.value[l])&&(C=Z.split(",")),a[l]=C}e.filter&&e.filter.sortBy&&(a.sortBy=e.filter.sortBy),e.page&&e.page.number&&await r.updateProductsPagination({currentPage:e.page.number}),await r.updateFilters(a)},b=async()=>{await r.setFilteringState(!0);let a=m.value._builder.query();await s(),M()},j=e=>{r.updateFilters({sortBy:e.slug})},M=()=>{if(typeof window>"u")return;let a=m.value._builder.query(),l=H().parse(a.substring(1));l=l||{},window.history.pushState({},"Search",a),P().info("pushed history state",l)},h=async()=>{await r.filter({})},s=_(async()=>{console.info("initiating filter"),await h()},500,{leading:!1,trailing:!0});return(e,a)=>{const l=(0,t.up)("Title"),Z=(0,t.up)("Meta"),C=(0,t.up)("Link"),pt=(0,t.up)("Head"),St=(0,t.up)("Html");return(0,t.wg)(),(0,t.iD)("div",st,[(0,t.Wm)(St,{lang:"en-US"},{default:(0,t.w5)(()=>[(0,t.Wm)(pt,null,{default:(0,t.w5)(()=>[(0,t.Wm)(l,null,{default:(0,t.w5)(()=>[rt]),_:1}),(0,t.Wm)(Z,{name:"description",content:"Carbar | Search"}),(0,u.SU)(w)?((0,t.wg)(),(0,t.j4)(C,{key:0,rel:"prev",href:`/search${(0,u.SU)(w)}`},null,8,["href"])):(0,t.kq)("",!0),(0,u.SU)(U)?((0,t.wg)(),(0,t.j4)(C,{key:1,rel:"next",href:`/search${(0,u.SU)(U)}`},null,8,["href"])):(0,t.kq)("",!0)]),_:1})]),_:1}),(0,t._)("div",at,[(0,t._)("div",it,[(0,t.Wm)(O.Z,{class:"pr-14"})]),(0,t._)("div",lt,[(0,t._)("div",ot,[(0,t.Wm)(R.Z,{crumbs:f}),ut,(0,t.Wm)(D.Z,{class:"mt-5"})]),(0,t._)("div",ct,[(0,t._)("div",dt,[(0,t._)("div",ft,[(0,u.SU)(o).total!==null?((0,t.wg)(),(0,t.iD)("span",vt,(0,A.zw)((0,u.SU)(o).total)+" cars",1)):(0,t.kq)("",!0),(0,t.Wm)(V.Z,{label:"Select an item",position:"left","menu-items":(0,u.SU)(v),onClickMenuItem:j},{"menu-button":(0,t.w5)(()=>[(0,t._)("div",mt,[yt,(0,t.Wm)(N.Z,null,{default:(0,t.w5)(()=>[(0,t.Uk)((0,A.zw)((0,u.SU)(g).label),1)]),_:1})])]),_:1},8,["menu-items"])])]),(0,t._)("div",gt,[(0,t.Wm)(k.Z),((0,u.SU)(o).total,(0,t.wg)(),(0,t.j4)(Q.Z,{key:0}))])])])])])}}}}}]);
