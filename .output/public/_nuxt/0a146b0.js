"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[863],{2863:(gt,U,n)=>{n.r(U),n.d(U,{default:()=>yt});var w=n(8104),t=n(597),y=n(6767),A=n(1559),R=n(4013),D=n(3810),O=n(3504),V=n(8217),H=n(3749),N=n(4160),z=n(7459),Q=n(5053),Y=n(6865),X=n(9158),G=function(){return X.Z.Date.now()};const j=G;var E=n(8071),J="Expected a function",K=Math.max,$=Math.min;function k(b,o,f){var s,g,h,u,a,l,c=0,C=!1,v=!1,d=!0;if(typeof b!="function")throw new TypeError(J);o=(0,E.Z)(o)||0,(0,Y.Z)(f)&&(C=!!f.leading,v="maxWait"in f,h=v?K((0,E.Z)(f.maxWait)||0,o):h,d="trailing"in f?!!f.trailing:d);function T(e){var i=s,r=g;return s=g=void 0,c=e,u=b.apply(r,i),u}function Z(e){return c=e,a=setTimeout(m,o),C?T(e):u}function p(e){var i=e-l,r=e-c,x=o-i;return v?$(x,h-r):x}function W(e){var i=e-l,r=e-c;return l===void 0||i>=o||i<0||v&&r>=h}function m(){var e=j();if(W(e))return I(e);a=setTimeout(m,p(e))}function I(e){return a=void 0,d&&s?T(e):(s=g=void 0,u)}function B(){a!==void 0&&clearTimeout(a),c=0,s=l=g=a=void 0}function P(){return a===void 0?u:I(j())}function S(){var e=j(),i=W(e);if(s=arguments,g=this,l=e,i){if(a===void 0)return Z(l);if(v)return clearTimeout(a),a=setTimeout(m,o),T(l)}return a===void 0&&(a=setTimeout(m,o)),u}return S.cancel=B,S.flush=P,S}const q=k;var _=n(1532),L=n.n(_),tt=n(5655),et=n(4120),F=n.n(et);const nt={class:"py-6 lg:py-8"},st={class:"container flex"},it={class:"w-3/12"},at={class:"w-9/12"},rt={class:"flex flex-col pb-8 border-b border-gray-300"},lt=(0,t._)("h1",{class:"mt-5 mb-0"},"Car subscriptions",-1),ot={class:"flex flex-col mt-6"},ut={class:"flex justify-end"},ct={class:"flex gap-x-6"},dt={key:0,class:"font-bold"},ft={class:"flex"},vt=(0,t._)("span",{class:"font-medium"},"Sort by:\xA0\xA0",-1),mt={class:"mt-6"},yt={props:{response:{type:Object}},emits:["click"],setup(b,{emit:o}){const f=b,s=(0,tt.M)(),g=(0,w.tv)(),h=(0,w.yj)(),u=[{title:"Home",url:"/"},{title:"Cars"}],a=(0,t.Fl)(()=>s.facets),l=(0,t.Fl)(()=>s.filters),c=(0,t.Fl)(()=>s.facets.sortBy),C=(0,t.Fl)(()=>s.filters.sortBy),v=(0,t.Fl)(()=>(0,Q.Z)(c.value,e=>e.slug===C.value)),d=(0,t.Fl)(()=>s.productsPagination),T=(0,t.Fl)(()=>s.isInitialPageLoaded),Z=(0,t.Fl)(()=>s.getCurrentQuery),p=(0,y.iH)(!1);(0,t.YP)(l,async(e,i)=>{!p.value||await m()},{deep:!0}),(0,t.YP)(()=>d.value.current,async(e,i)=>{!p.value||await m()}),(0,t.vl)(async()=>{F().info("onServerPrefetch"),await W()}),(0,t.bv)(async()=>{F().log("onMounted"),a.value.bodyTypes.length===0&&(F().warn("Server side fetch failed. Fetching on the client side"),await P()),p.value=!0});const W=async()=>{let e=L().parse(h.query);if(!e.filter)return;let i={};for(const[r,x]of Object.entries(e.filter)){if(!a.value[r])continue;let M=x;Array.isArray(l.value[r])&&(M=x.split(",")),i[r]=M}await s.updateFilters(i)},m=async()=>{await s.setFilteringState(!0);let i=Z.value._builder.query();await S(),B()},I=e=>{s.updateFilters({sortBy:e.slug})},B=()=>{if(typeof window>"u")return;let i=Z.value._builder.query(),r=L().parse(i.substring(1));r=r||{},window.history.pushState({},"Search",i),F().info("pushed history state",r)},P=async()=>{await s.filter({})},S=q(async()=>{console.info("initiating filter"),await P()},500,{leading:!1,trailing:!0});return(e,i)=>((0,t.wg)(),(0,t.iD)("div",nt,[(0,t._)("div",st,[(0,t._)("div",it,[(0,t.Wm)(O.Z,{class:"pr-14"})]),(0,t._)("div",at,[(0,t._)("div",rt,[(0,t.Wm)(R.Z,{crumbs:u}),lt,(0,t.Wm)(D.Z,{class:"mt-5"})]),(0,t._)("div",ot,[(0,t._)("div",ut,[(0,t._)("div",ct,[(0,y.SU)(d).total!==null?((0,t.wg)(),(0,t.iD)("span",dt,(0,A.zw)((0,y.SU)(d).total)+" cars",1)):(0,t.kq)("",!0),(0,t.Wm)(N.Z,{label:"Select an item",position:"left","menu-items":(0,y.SU)(c),onClickMenuItem:I},{"menu-button":(0,t.w5)(()=>[(0,t._)("div",ft,[vt,(0,t.Wm)(z.Z,null,{default:(0,t.w5)(()=>[(0,t.Uk)((0,A.zw)((0,y.SU)(v).label),1)]),_:1})])]),_:1},8,["menu-items"])])]),(0,t._)("div",mt,[(0,t.Wm)(V.Z),((0,y.SU)(d).total,(0,t.wg)(),(0,t.j4)(H.Z,{key:0}))])])])])]))}}}}]);
