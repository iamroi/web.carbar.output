"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[863],{2863:(gt,B,n)=>{n.r(B),n.d(B,{default:()=>yt});var U=n(8104),t=n(597),y=n(6767),A=n(1559),R=n(4013),D=n(3810),O=n(3504),V=n(8217),H=n(3749),N=n(4160),z=n(7459),Q=n(5053),Y=n(6865),X=n(9158),G=function(){return X.Z.Date.now()};const j=G;var E=n(8071),J="Expected a function",K=Math.max,$=Math.min;function k(C,o,f){var s,g,h,u,i,l,c=0,T=!1,v=!1,d=!0;if(typeof C!="function")throw new TypeError(J);o=(0,E.Z)(o)||0,(0,Y.Z)(f)&&(T=!!f.leading,v="maxWait"in f,h=v?K((0,E.Z)(f.maxWait)||0,o):h,d="trailing"in f?!!f.trailing:d);function Z(e){var a=s,r=g;return s=g=void 0,c=e,u=C.apply(r,a),u}function W(e){return c=e,i=setTimeout(m,o),T?Z(e):u}function p(e){var a=e-l,r=e-c,F=o-a;return v?$(F,h-r):F}function I(e){var a=e-l,r=e-c;return l===void 0||a>=o||a<0||v&&r>=h}function m(){var e=j();if(I(e))return P(e);i=setTimeout(m,p(e))}function P(e){return i=void 0,d&&s?Z(e):(s=g=void 0,u)}function w(){i!==void 0&&clearTimeout(i),c=0,s=l=g=i=void 0}function S(){return i===void 0?u:P(j())}function x(){var e=j(),a=I(e);if(s=arguments,g=this,l=e,a){if(i===void 0)return W(l);if(v)return clearTimeout(i),i=setTimeout(m,o),Z(l)}return i===void 0&&(i=setTimeout(m,o)),u}return x.cancel=w,x.flush=S,x}const q=k;var _=n(1532),L=n.n(_),tt=n(5655),et=n(4120),b=n.n(et);const nt={class:"py-6 lg:py-8"},st={class:"container flex"},at={class:"w-3/12"},it={class:"w-9/12"},rt={class:"flex flex-col pb-8 border-b border-gray-300"},lt=(0,t._)("h1",{class:"mt-5 mb-0"},"Car subscriptions",-1),ot={class:"flex flex-col mt-6"},ut={class:"flex justify-end"},ct={class:"flex gap-x-6"},dt={key:0,class:"font-bold"},ft={class:"flex"},vt=(0,t._)("span",{class:"font-medium"},"Sort by:\xA0\xA0",-1),mt={class:"mt-6"},yt={props:{response:{type:Object}},emits:["click"],setup(C,{emit:o}){const f=C,s=(0,tt.M)(),g=(0,U.tv)(),h=(0,U.yj)(),u=[{title:"Home",url:"/"},{title:"Cars"}],i=(0,t.Fl)(()=>s.facets),l=(0,t.Fl)(()=>s.filters),c=(0,t.Fl)(()=>s.facets.sortBy),T=(0,t.Fl)(()=>s.filters.sortBy),v=(0,t.Fl)(()=>(0,Q.Z)(c.value,e=>e.slug===T.value)),d=(0,t.Fl)(()=>s.productsPagination),Z=(0,t.Fl)(()=>s.isInitialPageLoaded),W=(0,t.Fl)(()=>s.getCurrentQuery),p=(0,y.iH)(!1);(0,t.YP)(l,async(e,a)=>{!p.value||await m()},{deep:!0}),(0,t.YP)(()=>d.value.current,async(e,a)=>{!p.value||await m()}),(0,t.vl)(async()=>{b().info("onServerPrefetch"),await I(),await S()}),(0,t.bv)(async()=>{b().log("onMounted"),i.value.bodyTypes.length===0&&(b().warn("Server side fetch failed. Fetching on the client side"),await S()),p.value=!0});const I=async()=>{let e=L().parse(h.query);if(!e.filter)return;let a={};for(const[r,F]of Object.entries(e.filter)){if(!i.value[r])continue;let M=F;Array.isArray(l.value[r])&&(M=F.split(",")),a[r]=M}await s.updateFilters(a)},m=async()=>{await s.setFilteringState(!0);let a=W.value._builder.query();await x(),w()},P=e=>{s.updateFilters({sortBy:e.slug})},w=()=>{if(typeof window>"u")return;let a=W.value._builder.query(),r=L().parse(a.substring(1));r=r||{},window.history.pushState({},"Search",a),b().info("pushed history state",r)},S=async()=>{await s.filter({})},x=q(async()=>{console.info("initiating filter"),await S()},500,{leading:!1,trailing:!0});return(e,a)=>((0,t.wg)(),(0,t.iD)("div",nt,[(0,t._)("div",st,[(0,t._)("div",at,[(0,t.Wm)(O.Z,{class:"pr-14"})]),(0,t._)("div",it,[(0,t._)("div",rt,[(0,t.Wm)(R.Z,{crumbs:u}),lt,(0,t.Wm)(D.Z,{class:"mt-5"})]),(0,t._)("div",ot,[(0,t._)("div",ut,[(0,t._)("div",ct,[(0,y.SU)(d).total!==null?((0,t.wg)(),(0,t.iD)("span",dt,(0,A.zw)((0,y.SU)(d).total)+" cars",1)):(0,t.kq)("",!0),(0,t.Wm)(N.Z,{label:"Select an item",position:"left","menu-items":(0,y.SU)(c),onClickMenuItem:P},{"menu-button":(0,t.w5)(()=>[(0,t._)("div",ft,[vt,(0,t.Wm)(z.Z,null,{default:(0,t.w5)(()=>[(0,t.Uk)((0,A.zw)((0,y.SU)(v).label),1)]),_:1})])]),_:1},8,["menu-items"])])]),(0,t._)("div",mt,[(0,t.Wm)(V.Z),((0,y.SU)(d).total,(0,t.wg)(),(0,t.j4)(H.Z,{key:0}))])])])])]))}}}}]);
